<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Studio - All-in-One Tools ğŸ› ï¸</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary: #4f46e5;
            --secondary: #ec4899;
            --bg: #f3f4f6;
            --text: #1f2937;
        }

        body {
            font-family: 'Inter', system-ui, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            max-width: 1000px;
            width: 100%;
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        header { text-align: center; margin-bottom: 2rem; }
        h1 { margin: 0; font-size: 2rem; color: var(--primary); }

        /* Tools Grid Section */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .tool-card {
            background: #fff;
            border: 1px solid #e5e7eb;
            padding: 1rem;
            border-radius: 0.75rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tool-card:hover { border-color: var(--primary); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .tool-card i { font-size: 2rem; display: block; margin-bottom: 0.5rem; }

        /* Upload and Controls */
        .upload-zone {
            border: 2px dashed #d1d5db;
            padding: 3rem;
            border-radius: 1rem;
            text-align: center;
            margin-bottom: 2rem;
            cursor: pointer;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            align-items: center;
            background: #f9fafb;
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-bottom: 2rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: opacity 0.2s;
        }

        .btn-primary { background: var(--primary); color: white; }
        .btn-pdf { background: var(--secondary); color: white; }

        /* Results Table */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        th { background: #f9fafb; padding: 1rem; text-align: left; border-bottom: 2px solid #e5e7eb; }
        td { padding: 1rem; border-bottom: 1px solid #f3f4f6; }

        .preview-thumb { width: 50px; height: 50px; object-fit: cover; border-radius: 4px; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ–¼ï¸ Image Studio</h1>
        <p>Compress, Convert, and Create PDFs instantly.</p>
    </header>

    <div class="tools-grid">
        <div class="tool-card"><i>ğŸ—œï¸</i>Compress</div>
        <div class="tool-card"><i>ğŸ“„</i>To PDF</div>
        <div class="tool-card"><i>ğŸ”„</i>Convert</div>
        <div class="tool-card"><i>âœ‚ï¸</i>Crop</div>
        <div class="tool-card"><i>ğŸ“</i>Resize</div>
    </div>

    <div class="upload-zone" onclick="document.getElementById('fileInput').click()">
        <p>ğŸ“ Drag and drop or click to upload images</p>
        <input type="file" id="fileInput" accept="image/*" multiple hidden>
    </div>

    <div class="controls">
        <div>
            <label>Compression Level: <span id="levelLabel">0.7</span> ğŸ›ï¸</label><br>
            <input type="range" id="compressLevel" min="0.1" max="1.0" step="0.1" value="0.7">
        </div>
        <button class="btn btn-primary" onclick="processImages()">Process All ğŸš€</button>
        <button class="btn btn-pdf" id="pdfBtn" style="display:none;" onclick="exportToPDF()">Save as PDF ğŸ“„</button>
    </div>

    <div id="resultsWrapper" style="display:none;">
        <h3>Results Table âœ¨</h3>
        <table>
            <thead>
                <tr>
                    <th>Preview ğŸ‘€</th>
                    <th>Name ğŸ“„</th>
                    <th>Status âœ…</th>
                    <th>Saved Size âš–ï¸</th>
                    <th>Action ğŸ“¥</th>
                </tr>
            </thead>
            <tbody id="resultBody"></tbody>
        </table>
    </div>
</div>

<script>
    const { jsPDF } = window.jspdf;
    let currentData = [];

    document.getElementById('compressLevel').oninput = (e) => {
        document.getElementById('levelLabel').innerText = e.target.value;
    };

    async function processImages() {
        const files = document.getElementById('fileInput').files;
        if (files.length === 0) return alert("Please upload images first.");

        const quality = parseFloat(document.getElementById('compressLevel').value);
        const resultBody = document.getElementById('resultBody');
        resultBody.innerHTML = "";
        currentData = [];

        for (let file of files) {
            const data = await compressFile(file, quality);
            currentData.push(data);
            appendRow(data);
        }

        document.getElementById('resultsWrapper').style.display = "block";
        document.getElementById('pdfBtn').style.display = "inline-block";
    }

    function compressFile(file, quality) {
        return new Promise((resolve) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = (e) => {
                const img = new Image();
                img.src = e.target.result;
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);
                    
                    const compressedUrl = canvas.toDataURL('image/jpeg', quality);
                    const originalSize = (file.size / 1024).toFixed(1);
                    const newSize = Math.round((compressedUrl.length * 3/4) / 1024);
                    
                    resolve({
                        name: file.name,
                        oldSize: originalSize,
                        newSize: newSize,
                        url: compressedUrl
                    });
                };
            };
        });
    }

    function appendRow(data) {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td><img src="${data.url}" class="preview-thumb"></td>
            <td>${data.name}</td>
            <td>Optimized ğŸ”¥</td>
            <td>${data.newSize} KB</td>
            <td><a href="${data.url}" download="studio_${data.name}" style="color:var(--primary); text-decoration:none; font-weight:bold;">Download ğŸ“¥</a></td>
        `;
        document.getElementById('resultBody').appendChild(row);
    }

    function exportToPDF() {
        const doc = new jsPDF();
        currentData.forEach((img, i) => {
            if (i > 0) doc.addPage();
            const props = doc.getImageProperties(img.url);
            const width = doc.internal.pageSize.getWidth();
            const height = (props.height * width) / props.width;
            doc.addImage(img.url, 'JPEG', 0, 0, width, height);
        });
        doc.save("image_studio_export.pdf");
    }
</script>

</body>
</html>
